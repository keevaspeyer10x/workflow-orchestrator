# Auto-load secrets when entering this directory
# Requires direnv: https://direnv.net/

# Set the age key file location (portable path)
export SOPS_AGE_KEY_FILE="${HOME}/.config/sops/age/keys.txt"

# Check if sops is available
SOPS_BIN="${HOME}/.local/bin/sops"
if [ -f "$SOPS_BIN" ] && [ -f "secrets.enc.yaml" ]; then
    export GEMINI_API_KEY=$($SOPS_BIN -d secrets.enc.yaml | grep gemini_api_key | cut -d: -f2 | tr -d ' ')
    export OPENROUTER_API_KEY=$($SOPS_BIN -d secrets.enc.yaml | grep openrouter_api_key | cut -d: -f2 | tr -d ' ')
    export OPENAI_API_KEY=$($SOPS_BIN -d secrets.enc.yaml | grep openai_api_key | cut -d: -f2 | tr -d ' ')
    export XAI_API_KEY=$($SOPS_BIN -d secrets.enc.yaml | grep grok_api_key | cut -d: -f2 | tr -d ' ')
fi

# Activate Python venv if it exists
if [ -d "venv" ]; then
    source venv/bin/activate
fi
